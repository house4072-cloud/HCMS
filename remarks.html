<!DOCTYPE html>
<html lang="ko">
  <link rel="stylesheet" href="assets/hcms.css">
<head>
  <meta charset="UTF-8" />
  <title>HCMS | 비고 리스트</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="app.js" type="module"></script>

  <style>
    body { font-family: Arial; padding: 20px; font-size: 17px; }
    h1 { margin-bottom: 20px; }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 14px;
      text-align: center;
    }

    tr { height: 50px; }
    th { background: #f4f4f4; }
  </style>
</head>
<body>

<h1>비고 리스트</h1>

<table>
  <thead>
    <tr>
      <th>크레인 번호</th>
      <th>비고 내용</th>
      <th>작성일</th>
      <th>해결 여부</th>
    </tr>
  </thead>
  <tbody id="remarkList"></tbody>
</table>

<script type="module">
  document.addEventListener("DOMContentLoaded", async () => {
    const { data, error } = await sb
      .from("remarks")
      .select("*")
      .order("created_at", { ascending: false });

    if (error) return alert(error.message);

    const tbody = document.getElementById("remarkList");
    data.forEach(r => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${r.crane_no}</td>
        <td>${r.content}</td>
        <td>${r.created_at?.slice(0,10)}</td>
        <td>${r.resolved ? "해결" : "미해결"}</td>
      `;
      tbody.appendChild(tr);
    });
  });
</script>

</body>
</html>
