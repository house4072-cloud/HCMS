<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HCMS | 소형크레인 리스트</title>
  <link rel="stylesheet" href="assets/hcms.css">
</head>

<body>

<header class="topbar">
  <img src="assets/hope.png" alt="희망이엔지">
  <div class="title">소형크레인 리스트</div>
  <img src="assets/hanwha.png" alt="한화에너지">
</header>

<main class="container">

  <section class="card">
    <h2>필터</h2>

    <div style="display:grid;grid-template-columns:repeat(6,1fr);gap:12px;margin-bottom:14px;">
      <select id="f_no_mode" class="input" onchange="applyNoModeFilterUI()">
        <option value="">번호구분 전체</option>
        <option value="input">번호입력</option>
        <option value="none">번호없음</option>
      </select>

      <input id="f_no" class="input" placeholder="크레인 번호 (예: C-014)" />

      <select id="f_area" class="input">
        <option value="">지역 전체</option>
        <option value="A">A</option>
        <option value="B">B</option>
      </select>

      <select id="f_type" class="input">
        <option value="">타입 전체</option>
        <option value="EOT">EOT</option>
        <option value="Suspension">Suspension</option>
        <option value="Gantry">Gantry</option>
        <option value="Post">Post</option>
        <option value="Wall">Wall</option>
        <option value="Monorail">Monorail</option>
        <option value="Service Crane">Service Crane</option>
      </select>

      <input id="f_brand" class="input" placeholder="브랜드" />
      <input id="f_ton" class="input" placeholder="톤수" />

      <select id="f_status" class="input">
        <option value="">상태 전체</option>
        <option value="완료">완료</option>
        <option value="보류">보류</option>
        <option value="미완">미완</option>
        <option value="미점검">미점검</option>
      </select>
    </div>

    <button class="btn" onclick="loadCranes()">필터 적용</button>

    <style>
      @media (max-width:900px){
        .card > div{ grid-template-columns:1fr!important; }
      }
    </style>
  </section>

  <section class="card">
    <h2>크레인 등록</h2>

    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px;">
      <select id="c_no_mode" class="input" style="max-width:220px;" onchange="setNoMode()">
        <option value="input">번호입력</option>
        <option value="none">번호없음</option>
      </select>
      <div style="color:#6b7280;font-weight:700;display:flex;align-items:center;">
        번호입력: 숫자만 치면 C- 자동 / 번호없음: “번호없음” 저장
      </div>
    </div>

    <div style="display:grid;grid-template-columns:repeat(6,1fr);gap:12px;margin-bottom:12px;">
      <input id="c_no" class="input" placeholder="크레인 번호(숫자만 가능)" onblur="autoCraneNoPrefix()" />

      <select id="c_area" class="input">
        <option value="">지역 선택</option>
        <option value="A">A</option>
        <option value="B">B</option>
      </select>

      <select id="c_type" class="input">
        <option value="">크레인 타입 선택</option>
        <option value="EOT">EOT</option>
        <option value="Suspension">Suspension</option>
        <option value="Gantry">Gantry</option>
        <option value="Post">Post</option>
        <option value="Wall">Wall</option>
        <option value="Monorail">Monorail</option>
        <option value="Service Crane">Service Crane</option>
      </select>

      <input id="c_brand" class="input" placeholder="브랜드" />
      <input id="c_ton" class="input" placeholder="톤수" />
      <input id="c_group" class="input" placeholder="그룹" />
    </div>

    <div style="display:grid;grid-template-columns:repeat(6,1fr);gap:12px;margin-bottom:12px;">
      <select id="c_hoist_type" class="input" onchange="toggleHoistDetail()">
        <option value="">호이스트 타입</option>
        <option value="Wire">Wire</option>
        <option value="Chain">Chain</option>
      </select>

      <input id="c_wire_dia" class="input" placeholder="와이어 Φ (숫자)" style="display:none;" />
      <input id="c_wire_len" class="input" placeholder="와이어 길이 M (숫자)" style="display:none;" />

      <select id="c_reeving" class="input" style="display:none;">
        <option value="">싱글/더블</option>
        <option value="Single">Single</option>
        <option value="Double">Double</option>
      </select>

      <div></div><div></div>
    </div>

    <button class="btn" onclick="addCrane()">크레인 등록/수정 저장</button>

    <style>
      @media (max-width:900px){
        section.card > div{ grid-template-columns:1fr!important; }
      }
    </style>
  </section>

  <section class="card">
    <h2>리스트</h2>
    <table>
      <thead>
        <tr>
          <th>번호</th>
          <th>지역</th>
          <th>타입</th>
          <th>브랜드</th>
          <th>톤수</th>
          <th>호이스트</th>
          <th>그룹</th>
          <th>상태</th>
          <th>관리</th>
        </tr>
      </thead>
      <tbody id="craneList"></tbody>
    </table>
  </section>

</main>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="app.js"></script>

<script>
  function setNoMode() {
    const mode = document.getElementById("c_no_mode")?.value;
    const no = document.getElementById("c_no");
    if (!no) return;

    if (mode === "none") {
      no.value = "번호없음";
      no.readOnly = true;
      no.style.background = "#f3f4f6";
    } else {
      if (no.value === "번호없음") no.value = "";
      no.readOnly = false;
      no.style.background = "";
    }
  }

  document.addEventListener("DOMContentLoaded", () => {
    setNoMode();
  });
</script>

</body>
</html>
 
